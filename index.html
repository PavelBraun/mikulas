<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1024, initial-scale=1.0">
    <title>MikulÃ¡Å¡skÃ¡ aplikace</title>
    <link rel="icon" type="image/png" href="images/app-icon.png">
    <link rel="stylesheet" href="style.css">
    <style>
        /* JemnÃ¡ vizuÃ¡lnÃ­ zpÄ›tnÃ¡ vazba pro PINpad tlaÄÃ­tka */
        .pinpad-btn { transition: opacity 80ms ease; }
        .pinpad-btn:hover { opacity: 0.7; }
        .pinpad-btn:active { transform: translateY(1px); }
        /* Tisk: skrÃ½t ovlÃ¡dacÃ­ prvky a tlaÄÃ­tka; tisknout pouze dopis, bez pozadÃ­ */
        @page { size: auto; margin: 12mm; }
        @media print {
            /* Reset vÃ½chozÃ­ho layoutu pro tisk */
            html, body { height: 100% !important; margin: 0 !important; padding: 0 !important; background: none !important; }

            /* Skryjeme vÅ¡e, co nenÃ­ dopis */
            .no-print, .btn-large, .btn-small, button, .help-btn, .modal, .pinpad-btn, .admin-screen, .screen:not(#letterScreen) { display: none !important; }

            /* ZajistÃ­me, Å¾e letterScreen zabere celou strÃ¡nku a obsah bude centrovÃ¡n */
            #letterScreen { display: block !important; min-height: 100vh !important; box-sizing: border-box !important; }
            #letterScreen .content { display: flex !important; align-items: center !important; justify-content: center !important; height: 100% !important; margin: 0 !important; }

            /* Pergamen bude formÃ¡tovÃ¡n jako ÃºÄtenka: Å¡Ã­Å™ka 80mm, menÅ¡Ã­ padding a fonty; vycentrovÃ¡no horizontÃ¡lnÄ›, nahoÅ™e vertikÃ¡lnÄ› */
            @page { size: 80mm auto; margin: 6mm; }
            #letterScreen .content { display: flex !important; align-items: flex-start !important; justify-content: center !important; height: 100% !important; }
            .parchment { box-shadow: none !important; background: #fff !important; width: 80mm !important; max-width: 80mm !important; padding: 6mm !important; margin: 0 auto !important; font-size: 11px !important; line-height: 1.2 !important; }

            /* Pokud chceÅ¡ jinou Å¡Ã­Å™ku ÃºÄtenky, uprav parametry width/padding vÃ½Å¡e */

            /* Text dopisu ÄernÄ› a ÄitelnÄ› */
            #letterText { color: #000 !important; }
        }
    </style>
</head>
<body>

    <!-- Overlay PINpad -->
    <div id="pinpadOverlay" style="position: fixed; left: 0; top: 0; width: 1024px; height: 1280px; background: rgba(0,0,0,0); z-index: 2000; align-items: center; justify-content: center;">
    <div style="position: absolute; left: 200px; top: 910px;">
            <h2 style="text-align:center; margin-bottom:12px;">&nbsp;</h2>
            <div id="pinpadDigits" style="display:flex; justify-content:center; gap:8px; margin-top:16px;"></div>
            <div style="display:grid; grid-template-columns:repeat(3,100px); gap:12px; justify-content:center;">
                <button class="pinpad-btn" data-digit="1">1</button>
                <button class="pinpad-btn" data-digit="2">2</button>
                <button class="pinpad-btn" data-digit="3">3</button>
                <button class="pinpad-btn" data-digit="4">4</button>
                <button class="pinpad-btn" data-digit="5">5</button>
                <button class="pinpad-btn" data-digit="6">6</button>
                <button class="pinpad-btn" data-digit="7">7</button>
                <button class="pinpad-btn" data-digit="8">8</button>
                <button class="pinpad-btn" data-digit="9">9</button>
                <button class="pinpad-btn" data-action="clear">C</button>
                <button class="pinpad-btn" data-digit="0">0</button>
                <button class="pinpad-btn" data-action="ok">OK</button>
            </div>
        </div>
    </div>
    <!-- ÃšvodnÃ­ obrazovka -->
    <div id="welcomeScreen" class="screen active" style="background-image: url('images/bg-welcome.png')">
        <div class="content">
            <h1>VÃ­tej!</h1>
            <button onclick="app.goToPin()" class="btn-large">ZaÄÃ­t</button>
        </div>
    </div>

    <!-- PIN obrazovka -->
    <div id="pinScreen" class="screen" style="background-image: url('images/bg-pin.png')">
        <button class="secret-joke-btn" onclick="app.triggerJoke()"></button>
        <div class="content">
            <div class="pin-inputs">
                <input type="tel" maxlength="1" class="pin-digit" data-index="0" pattern="[0-9]*" inputmode="numeric" onclick="app.secretCode()">
                <input type="tel" maxlength="1" class="pin-digit" data-index="1" pattern="[0-9]*" inputmode="numeric" onclick="app.secretCode()">
                <input type="tel" maxlength="1" class="pin-digit" data-index="2" pattern="[0-9]*" inputmode="numeric" onclick="app.secretCode()">
                <input type="tel" maxlength="1" class="pin-digit" data-index="3" pattern="[0-9]*" inputmode="numeric" onclick="app.secretCode()">
            </div>
        </div>
    </div>

    <!-- Kolo Å¡tÄ›stÃ­ -->
    <div id="wheelScreen" class="screen" style="background-image: url('images/bg-kolo.png')">
        <div class="content">
            <canvas id="wheelCanvas" width="600" height="600"></canvas>
            <div class="loading-container">
                <div class="loading-text">HledÃ¡m ve svÃ½ch poznÃ¡mkÃ¡ch...</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>
            <button onclick="app.spinWheel()" id="spinButton" class="btn-large" style="display: none;">RoztoÄit</button>
        </div>
    </div>

    <!-- Dopis na pergamenu -->
    <div id="letterScreen" class="screen" style="background-image: url('images/bg-letter.png')">
        <button id="printButton" class="btn-small no-print" onclick="app.showPrintPreview()" style="position:absolute; right:20px; top:20px; z-index:2000; display: none;">Tisk</button>
        <button class="secret-regenerate-btn" onclick="app.regenerateContent()"></button>
        <div class="content">
            <div class="parchment">
                <div id="letterText" class="letter-text"></div>
            </div>
                <button id="endLetterButton" onclick="app.finishLetterAndPrint()" class="btn-large continue">DokonÄit</button>
        </div>
    </div>

    <!-- Print preview lightbox -->
    <div id="printPreview" class="modal no-print" style="display:none; align-items:center; justify-content:center;">
        <div class="print-preview-content" style="position:relative; width:820px; max-width:95%;">
            <div class="print-preview-bg" style="background-size: cover; padding: 40px;">
                <div id="printPreviewLetter" style="background: rgba(255,255,255,0.0);">
                </div>
            </div>
            <div style="position:absolute; right:12px; top:12px; display:flex; gap:8px;">
                <button class="btn-small" onclick="app.printPreview();">Tisk</button>
                <button class="btn-small" onclick="app.closePrintPreview();">ZavÅ™Ã­t</button>
            </div>
        </div>
    </div>

    <!-- RozlouÄenÃ­ -->
    <div id="goodbyeScreen" class="screen" style="background-image: url('images/bg-goodbye.png')">
        <div class="content">
            <h1>DÄ›kujeme,<br>a tÄ›Å¡Ã­me se na dalÅ¡Ã­ setkÃ¡nÃ­!</h1>
            <button onclick="app.restart()" class="btn-large">ZaÄÃ­t znovu</button>
        </div>
    </div>

    <!-- Admin panel -->
    <div id="adminScreen" class="screen admin-screen">
        <button class="help-btn" onclick="app.showHelp()" title="NÃ¡povÄ›da">?</button>
        <button class="close-admin-btn" onclick="app.closeAdmin()" title="ZavÅ™Ã­t administraci">âœ•</button>
        <div class="content">
            <h1>Administrace</h1>
            <div id="dropZone" class="file-drop-zone"><p>PÅ™etÃ¡hnÄ›te sem zÃ¡lohu (.json nebo .csv)</p><input type="file" id="dropZoneFileInput" style="display:none" accept=".json,.csv"></div>
            <button type="button" onclick="app.exportBackup()" class="btn-large continue">ğŸ’¾ ZÃ¡lohovat</button>
            <button type="button" id="resetDataBtn" class="btn-large continue btn-danger">ğŸ—‘ï¸ ZaÄÃ­t znovu</button>
            <button type="button" id="soundToggle" class="btn-large continue">Zvuk ON</button>
            <button type="button" id="autoPrintToggle" class="btn-large continue">AutoTisk ON</button>
                
            <div class="admin-tabs">
                <button class="admin-tab-btn" id="tab-names" onclick="app.switchAdminTab('names')">JmÃ©na</button>
                <button class="admin-tab-btn" id="tab-jokes" onclick="app.switchAdminTab('jokes')">Vtipy</button>
                <button class="admin-tab-btn" id="tab-phrases" onclick="app.switchAdminTab('phrases')">FRAZE</button>
            </div>
            <div id="adminTabContent">
                <!-- Dynamicky generovÃ¡no JS -->
            </div>
            <div class="admin-controls" style="margin-top:12px; display:flex; gap:8px; align-items:center;">
                
            </div>
            <button onclick="app.closeAdmin()" class="btn-large continue">ZavÅ™Ã­t administraci</button>
        </div>
    </div>

    <!-- Modal pro editaci jmÃ©na/vtipu/fraze -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <h2 id="editModalTitle">Upravit</h2>
            <label id="editModalLabel">PoznÃ¡mka:</label>
            <textarea id="modalEditText"></textarea>
            <div class="modal-buttons">
                <button class="btn-edit" onclick="app.saveEditModal()">ğŸ’¾ UloÅ¾it</button>
                <button class="btn-edit" onclick="app.closeModal()">âŒ ZruÅ¡it</button>
            </div>
        </div>
    </div>

    <!-- Modal pro import -->
    <div id="importModal" class="modal">
        <div class="modal-content">
            <h2 id="importModalTitle">Importovat CSV</h2>
            <input type="file" id="importFileInput" accept=".csv">
            <div class="modal-buttons">
                <button class="btn-edit" onclick="app.importCSVModal()">ğŸ“‚ Importovat</button>
                <button class="btn-edit" onclick="app.closeImportModal()">âŒ ZruÅ¡it</button>
            </div>
            <div id="importTemplateLink"></div>
        </div>
    </div>

    <!-- Modal s nÃ¡povÄ›dou -->
    <div id="helpModal" class="modal">
        <div class="modal-content help-modal">
            <button class="modal-close-btn" onclick="app.closeHelp()" title="ZavÅ™Ã­t">âœ•</button>
            <h2>ğŸ“– Dokumentace MikulÃ¡Å¡skÃ© aplikace</h2>
            
            <div class="help-section">
                <p>Pro vÃ­ceÅ™Ã¡dkovÃ½ text pouÅ¾ijte uvozovky. Excel: uloÅ¾te jako CSV UTF-8.</p>
                                    MikulÃ¡Å¡ a spol.</pre>
            </div>
                <div class="help-section">
                    <h3>ğŸ¯ ZÃ¡kladnÃ­ pouÅ¾itÃ­</h3>
                    <p>Aplikace slouÅ¾Ã­ k zobrazenÃ­ personalizovanÃ½ch dopisÅ¯ od MikulÃ¡Å¡e. KaÅ¾dÃ© dÃ­tÄ› mÃ¡ svÅ¯j unikÃ¡tnÃ­ PIN kÃ³d. K dispozici je administrace pro sprÃ¡vu dÄ›tÃ­, vtipÅ¯ a motivaÄnÃ­ch frÃ¡zÃ­.</p>
                </div>

                <div class="help-section">
                    <h3>ğŸ”¢ SpeciÃ¡lnÃ­ PIN kÃ³dy</h3>
                    <ul>
                        <li><strong>9989</strong> - Vstup do administrace</li>
                        <li><strong>7897</strong> - Fortune cookie (nÃ¡hodnÃ½ motivaÄnÃ­ citÃ¡t)</li>
                        <li><strong>1231</strong> - Å tÄ›stÃ­Äko s motivaÄnÃ­m citÃ¡tem</li>
                        <li><strong>4564</strong> - VtipnÃ½ reÅ¾im s nÃ¡hodnÃ½m vtipem</li>
                    </ul>
                </div>

                <div class="help-section">
                    <h3>ğŸ® OvlÃ¡dÃ¡nÃ­</h3>
                    <ul>
                        <li><strong>Enter</strong> - PotvrzenÃ­ na obrazovkÃ¡ch s jednÃ­m tlaÄÃ­tkem</li>
                        <li><strong>MezernÃ­k</strong> - TajnÃ½ kÃ³d (PIN 7897) na PIN obrazovce</li>
                        <li><strong>KliknutÃ­ na PIN pole</strong> - TakÃ© spustÃ­ tajnÃ½ kÃ³d (7897)</li>
                        <li><strong>Drag & Drop</strong> - PÅ™etÃ¡hnÄ›te zÃ¡lohu (.json/.csv) na dropzonu v administraci</li>
                    </ul>
                </div>

                <div class="help-section">
                    <h3>ğŸ‘¥ Administrace</h3>
                    <ul>
                        <li>Taby pro sprÃ¡vu: JmÃ©na, Vtipy, FRAZE</li>
                        <li>PÅ™idÃ¡nÃ­, Ãºprava, mazÃ¡nÃ­ poloÅ¾ek</li>
                        <li>Export/import CSV pro kaÅ¾dou sekci</li>
                        <li>Export zÃ¡lohy aplikace (JSON)</li>
                        <li>PotvrzenÃ­ mazÃ¡nÃ­: kliknÄ›te dvakrÃ¡t na tlaÄÃ­tko ğŸ—‘ï¸</li>
                        <li>Reset dat: tlaÄÃ­tko vymazat data a zaÄÃ­t znovu (potvrzenÃ­)</li>
                        <li>NÃ¡povÄ›da: tlaÄÃ­tko ? vpravo nahoÅ™e</li>
                    </ul>
                </div>

                <div class="help-section">
                    <h3>ğŸ’¾ Import a Export</h3>
                    <p><strong>Export jmen:</strong> CSV soubor s PIN, JmÃ©no, Text dopisu.</p>
                    <p><strong>Export vtipÅ¯/frÃ¡zÃ­:</strong> CSV soubor s poznÃ¡mkami.</p>
                    <p><strong>Export zÃ¡lohy:</strong> JSON soubor s celou databÃ¡zÃ­.</p>
                    <p><strong>Import:</strong> Podporuje formÃ¡ty .json a .csv. PÅ™etÃ¡hnÄ›te soubor na dropzonu nebo pouÅ¾ijte tlaÄÃ­tko Importovat.</p>
                    <p><strong>CSV formÃ¡t:</strong></p>
                    <pre>PIN,Jmeno,Text dopisu
                    <p>Pro vÃ­ceÅ™Ã¡dkovÃ½ text pouÅ¾ijte uvozovky. Excel: uloÅ¾te jako CSV UTF-8.</p>
                </div>

                <div class="help-section">
                    <h3>âœ‰ï¸ FormÃ¡t dopisu</h3>
                    <p>K textu dopisu se automaticky pÅ™idÃ¡vÃ¡ patiÄka: UÅ¾ij si svou odmÄ›nu!</p>
                    
                </div>

                <div class="help-section">
                    <h3>ğŸª Fortune Cookie (PIN 7897)</h3>
                    <p>SpeciÃ¡lnÃ­ PIN generuje nÃ¡hodnÃ© jmÃ©no a motivaÄnÃ­ citÃ¡t. DÃ­tÄ› nenÃ­ uloÅ¾eno do databÃ¡ze.</p>
                </div>

                <div class="help-section">
                    <h3>ğŸ˜„ VtipnÃ½ reÅ¾im (PIN 4564)</h3>
                    <p>SpeciÃ¡lnÃ­ PIN zobrazuje nÃ¡hodnÃ½ vtip. PerfektnÃ­ pro pobavenÃ­!</p>
                </div>

                <div class="help-section">
                    <h3>âš™ï¸ TechnickÃ© informace</h3>
                    <ul>
                        <li>Data jsou uloÅ¾ena v lokÃ¡lnÃ­m ÃºloÅ¾iÅ¡ti prohlÃ­Å¾eÄe</li>
                        <li>RozliÅ¡enÃ­: 1024Ã—1280 px (kiosek reÅ¾im)</li>
                        <li>DoporuÄenÃ½ prohlÃ­Å¾eÄ: Chrome, Edge</li>
                    </ul>
                </div>
    </div>
</body>

    <script src="app.js"></script>
</html>
